import { parseFromString } from 'dom-parser';
export const metaTagPropertyRegex = /^(fc|frog|og:image|og:title)/;
/**
 * Extracts frame metadata from a given URL.
 *
 * @example
 * import { getFrameMetadata } from 'frog'
 * const frameMetadata = await getFrameMetadata(`https://myframe.com/api`)
 */
export async function getFrameMetadata(url) {
    try {
        const text = await fetch(url).then((r) => r.text());
        const dom = parseFromString(text.replace(/<!doctype html>/i, ''));
        const nodes = dom.getElementsByTagName('meta');
        const metaTags = [];
        for (const node of nodes) {
            const property = node.getAttribute('property');
            const content = node.getAttribute('content');
            if (!property.match(metaTagPropertyRegex))
                continue;
            metaTags.push({
                property: property,
                content,
            });
        }
        return metaTags;
    }
    catch (error) {
        throw new Error([
            `Failed to extract frame meta tags from "${url}".`,
            '',
            `Error: ${error}`,
        ].join('\n'));
    }
}
//# sourceMappingURL=getFrameMetadata.js.map